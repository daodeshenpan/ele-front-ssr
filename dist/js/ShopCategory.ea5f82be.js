(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{160:function(t,e,i){},161:function(t,e,i){"use strict";i.d(e,"f",(function(){return s})),i.d(e,"d",(function(){return o})),i.d(e,"e",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return c}));var s=function(t,e){t&&localStorage.setItem(t,JSON.stringify(e))},o=function(t){if(t)return JSON.parse(localStorage.getItem(t))},n=function(t){t&&localStorage.removeItem(t)},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t.children[t.children.length-1],s=a(i);return s+e<t.parentElement.clientHeight+t.parentElement.scrollTop},a=function(t){for(var e=t.offsetTop;t=t.offsetParent;)e+=t.offsetTop;return e};var c=function(t,e,i,s,o){clearInterval(t.timer),t.timer=setInterval((function(){var s,n=!0,r=0,a=0,c=0;for(s in e)"opacity"===s?(r=100*parseFloat(window.getComputedStyle(t).opacity),a=100*parseFloat(e.opacity)):"scrollTop"===s?(r=t.scrollTop,a=parseInt(e.scrollTop)):(r=parseInt(window.getComputedStyle(t)[s]),a=parseInt(e[s])),c=a>r?Math.ceil((a-r)*i):Math.floor((a-r)*i),"opacity"===s?t.style.opacity=(r+c)/100:"scrollTop"===s?t.scrollTop=r+c:"zIndex"===s?t.style.zIndex=a:t.style[s]=r+c+"px",Math.round(r)!==Math.round(a)&&(n=!1);if(n){for(s in clearInterval(t.timer),e)"opacity"===s||"zIndex"===s?t.style[s]=parseFloat(e[s]):"scrollTop"===s?t.scrollTop=parseFloat(e.scrollTop):t.style[s]=parseFloat(e[s])+"px";o&&o()}}),s)}},162:function(t,e,i){},163:function(t,e,i){"use strict";var s=i(160);i.n(s).a},165:function(t,e,i){"use strict";var s=function(){var t=this.$createElement;return(this._self._c||t)("i",{staticClass:"el-icon-loading loading"})};s._withStripped=!0;var o={name:"LoadingIcon"},n=(i(163),i(7)),r=Object(n.a)(o,s,[],!1,null,null,null);r.options.__file="src/components/LoadingIcon.vue";e.a=r.exports},168:function(t,e,i){"use strict";var s=i(162);i.n(s).a},170:function(t,e,i){},191:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"shop-list"},[t.data.length?t._e():i("li",{staticStyle:{"border-bottom":"0",padding:"0"}},[i("loading-icon")],1),t._v(" "),t._l(t.data,(function(e,s){return t.data.length?i("li",{key:s,on:{tap:function(i){return t.toShop(e)}}},[i("img",{attrs:{src:t.imgBaseURL+e.image_path,alt:""}}),t._v(" "),i("div",{staticClass:"shop-list-info"},[i("div",{staticClass:"shop-list-info-header"},[i("h4",{class:["ellipsis",{premium:e.is_premium}]},[t._v(t._s(e.name))]),t._v(" "),i("ul",t._l(e.supports,(function(e){return i("li",{staticClass:"support"},[t._v(t._s(e.icon_name))])})),0)]),t._v(" "),i("div",{staticClass:"shop-list-info-content"},[i("div",[i("em",[t._v(t._s(e.rating))]),t._v(" "),i("b",[t._v("月售"+t._s(e.recent_order_num)+"单")])]),t._v(" "),i("div",[e.delivery_mode?i("i",[t._v("蜂鸟专送")]):t._e(),t._v(" "),t.isPunctual(e.supports)?i("span",[t._v("准时达")]):t._e()])]),t._v(" "),i("div",{staticClass:"shop-list-info-footer"},[i("b",[t._v("￥"+t._s(e.float_minimum_order_amount)+"起送/￥"+t._s(e.float_delivery_fee)+"配送")]),t._v(" "),i("em",[t._v(t._s(e.distance)+"/"+t._s(e.order_lead_time))])])])]):t._e()})),t._v(" "),t.data.length&&t.haveMore?i("li",{staticStyle:{position:"relative"}},[i("loading-icon")],1):t._e()],2)};s._withStripped=!0;var o=i(56),n={name:"ShopList",components:{LoadingIcon:i(165).a},props:{data:Array,haveMore:Boolean},data:function(){return{imgBaseURL:o.b}},methods:{isPunctual:function(t){return!(!Array.isArray(t)||!t.length)&&t.some((function(t){return"准"===t.icon_name}))},toShop:function(t){this.$router.push("/shop?geohash=".concat(this.$route.query.geohash,"&id=").concat(t.id))}}},r=(i(168),i(7)),a=Object(r.a)(n,s,[],!1,null,null,null);a.options.__file="src/components/ShopList.vue";e.a=a.exports},195:function(t,e,i){"use strict";var s=i(170);i.n(s).a},232:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"shop-category"},on:{swipeend:t.handleSwipeend}},[i("top-bar",{attrs:{"show-back":"",title:t.$route.query.title}}),t._v(" "),i("ul",{staticClass:"sort-container clearfix"},[i("li",{class:{checked:t.categoryClick},on:{tap:function(e){t.categoryClick=!t.categoryClick,t.sortClick=!1,t.siftClick=!1}}},[t._v("\n            分类"),i("i",{staticClass:"el-icon-caret-bottom"}),t._v(" "),i("transition",{attrs:{name:"zoom-in-top"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.categoryClick,expression:"categoryClick"}],staticClass:"category-dropdown"})])],1),t._v(" "),i("li",{class:{checked:t.sortClick},on:{tap:function(e){t.sortClick=!t.sortClick,t.categoryClick=!1,t.siftClick=!1}}},[t._v("\n            排序"),i("i",{staticClass:"el-icon-caret-bottom"}),t._v(" "),i("transition",{attrs:{name:"zoom-in-top"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.sortClick,expression:"sortClick"}],staticClass:"sort-dropdown"},[i("div",{staticClass:"sort-dropdown-item",class:{checked:4===t.sortIndex[0]},on:{tap:function(e){return t.sortIndex.splice(0,1,4)}}},[i("i",{staticClass:"el-icon-sort"},[t._v("智能排序")])]),t._v(" "),i("div",{staticClass:"sort-dropdown-item",class:{checked:5===t.sortIndex[0]},on:{tap:function(e){return t.sortIndex.splice(0,1,5)}}},[i("i",{staticClass:"el-icon-location-outline"},[t._v("距离最近")])]),t._v(" "),i("div",{staticClass:"sort-dropdown-item",class:{checked:6===t.sortIndex[0]},on:{tap:function(e){return t.sortIndex.splice(0,1,6)}}},[i("i",{staticClass:"el-icon-paperclip"},[t._v("销量最高")])]),t._v(" "),i("div",{staticClass:"sort-dropdown-item",class:{checked:1===t.sortIndex[0]},on:{tap:function(e){return t.sortIndex.splice(0,1,1)}}},[i("i",{staticClass:"el-icon-apple"},[t._v("起送最低")])]),t._v(" "),i("div",{staticClass:"sort-dropdown-item",class:{checked:2===t.sortIndex[0]},on:{tap:function(e){return t.sortIndex.splice(0,1,2)}}},[i("i",{staticClass:"el-icon-tableware"},[t._v("配送最快")])]),t._v(" "),i("div",{staticClass:"sort-dropdown-item",class:{checked:3===t.sortIndex[0]},on:{tap:function(e){return t.sortIndex.splice(0,1,3)}}},[i("i",{staticClass:"el-icon-coffee"},[t._v("评分最高")])])])])],1),t._v(" "),i("li",{class:{checked:t.siftClick},on:{tap:function(e){t.categoryClick=!1,t.sortClick=!1}}},[i("span",{on:{tap:function(e){t.siftClick=!t.siftClick}}},[t._v("筛选"),i("i",{staticClass:"el-icon-caret-bottom"})]),t._v(" "),i("transition",{attrs:{name:"zoom-in-top"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.siftClick,expression:"siftClick"}],staticClass:"sift-dropdown clearfix"},[i("h5",[t._v("配送方式")]),t._v(" "),i("button",{class:{checked:!0===t.hummingBird},on:{tap:function(e){t.hummingBird=!t.hummingBird}}},[t._v("蜂鸟配送\n                    ")]),t._v(" "),i("h5",[t._v("商家特色")]),t._v(" "),i("button",{class:{checked:t.brand},on:{tap:function(e){t.brand=!t.brand}}},[t._v("品牌商家")]),t._v(" "),i("button",{class:{checked:t.insurance},on:{tap:function(e){t.insurance=!t.insurance}}},[t._v("外卖保")]),t._v(" "),i("button",{class:{checked:t.onTime},on:{tap:function(e){t.onTime=!t.onTime}}},[t._v("准时达")]),t._v(" "),i("button",{class:{checked:t.recent},on:{tap:function(e){t.recent=!t.recent}}},[t._v("新店")]),t._v(" "),i("button",{class:{checked:t.online},on:{tap:function(e){t.online=!t.online}}},[t._v("在线支付")]),t._v(" "),i("button",{class:{checked:t.invoice},on:{tap:function(e){t.invoice=!t.invoice}}},[t._v("开发票")]),t._v(" "),i("div",{on:{tap:function(e){t.siftClick=!1}}},[t._v("取消")]),t._v(" "),i("div",{on:{tap:function(e){t.siftClick=!1,t.confirm()}}},[t._v("确定")])])])],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.categoryClick||t.sortClick||t.siftClick,expression:"categoryClick||sortClick||siftClick"}],staticClass:"mask",on:{tap:function(e){t.categoryClick=!1,t.sortClick=!1,t.siftClick=!1}}}),t._v(" "),i("shop-list",{ref:"shopList",staticStyle:{"min-height":"100%"},attrs:{data:t.categoryShopList,"have-more":t.categoryHaveMore}})],1)};s._withStripped=!0;i(60),i(61),i(57),i(43),i(58),i(59),i(156);var o=i(27),n=i.n(o),r=i(13),a=i(55),c=i(191),l=i(161);function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}var u={name:"ShopCategory",components:{TopBar:a.a,ShopList:c.a},data:function(){return{id:this.$route.query.id,geohash:this.$route.query.geohash,categoryClick:!1,sortClick:!1,siftClick:!1,sortIndex:[4],deliveryMode:[],hummingBird:!1,supportIDs:[],brand:!1,insurance:!1,onTime:!1,recent:!1,online:!1,invoice:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},Object(r.c)(["categoryShopList"]),{},Object(r.b)(["categoryHaveMore"])),watch:{id:function(){this.initData()},geohash:function(){this.initData()},sortIndex:function(){this.initData()},deliveryMode:function(){this.initData()},supportIDs:function(){this.initData()}},beforeRouteEnter:function(t,e,i){"/shop"===e.path?t.meta.transitionName="slide-to-bottom":t.meta.transitionName="slide-to-left",i()},asyncData:function(t){var e=t.store,i=t.route,s=i.query.id,o=i.query.geohash;return e.commit("setCategoryShopListIndex",0),e.dispatch("fetchCategoryShopList",{latitude:o.split(",")[0],longitude:o.split(",")[1],offset:e.state.shopListLimit*e.state.categoryShopListIndex,limit:e.state.shopListLimit,restaurant_category_ids:[s]})},activated:function(){this.id=this.$route.query.id,this.geohash=this.$route.query.geohash},deactivated:function(){this.categoryClick=!1,this.sortClick=!1,this.siftClick=!1,this.sortIndex[0]=4,this.deliveryMode.length=0,this.supportIDs.length=0,this.hummingBird=!1,this.brand=!1,this.insurance=!1,this.onTime=!1,this.recent=!1,this.online=!1,this.invoice=!1},methods:{initData:function(){var t=this.$store,e=this.id,i=this.geohash;return t.commit("setCategoryShopList",[]),t.commit("setCategoryShopListIndex",0),t.dispatch("fetchCategoryShopList",{latitude:i.split(",")[0],longitude:i.split(",")[1],order_by:this.sortIndex[0],offset:t.state.shopListLimit*t.state.categoryShopListIndex,limit:t.state.shopListLimit,restaurant_category_ids:[e],delivery_mode:this.deliveryMode,support_ids:this.supportIDs})},loadMore:function(){var t=this.$store,e=this.id,i=this.geohash;return t.dispatch("fetchMoreCategoryShopList",{latitude:i.split(",")[0],longitude:i.split(",")[1],order_by:this.sortIndex[0],offset:t.state.shopListLimit*t.state.categoryShopListIndex,limit:t.state.shopListLimit,restaurant_category_ids:[e],delivery_mode:this.deliveryMode,support_ids:this.supportIDs})},confirm:function(){if(this.hummingBird)-1===this.deliveryMode.indexOf(1)&&this.deliveryMode.push(1);else{var t=this.deliveryMode.indexOf(1);t>-1&&this.deliveryMode.splice(t,1)}if(this.brand)-1===this.supportIDs.indexOf(8)&&this.supportIDs.push(8);else{var e=this.supportIDs.indexOf(8);e>-1&&this.supportIDs.splice(e,1)}if(this.insurance)-1===this.supportIDs.indexOf(7)&&this.supportIDs.push(7);else{var i=this.supportIDs.indexOf(7);i>-1&&this.supportIDs.splice(i,1)}if(this.onTime)-1===this.supportIDs.indexOf(9)&&this.supportIDs.push(9);else{var s=this.supportIDs.indexOf(9);s>-1&&this.supportIDs.splice(s,1)}if(this.recent)-1===this.supportIDs.indexOf(5)&&this.supportIDs.push(5);else{var o=this.supportIDs.indexOf(5);o>-1&&this.supportIDs.splice(o,1)}if(this.online)-1===this.supportIDs.indexOf(3)&&this.supportIDs.push(3);else{var n=this.supportIDs.indexOf(3);n>-1&&this.supportIDs.splice(n,1)}if(this.invoice)-1===this.supportIDs.indexOf(4)&&this.supportIDs.push(4);else{var r=this.supportIDs.indexOf(4);r>-1&&this.supportIDs.splice(r,1)}},handleSwipeend:function(){var t=this,e=this.$refs.shopList.$el.parentElement.scrollTop;requestAnimationFrame((function(){t.$refs.shopList.$el.parentElement.scrollTop!==e?t.handleSwipeend():Object(l.c)(t.$refs.shopList.$el)&&t.categoryHaveMore&&t.loadMore()}))}}},d=(i(195),i(7)),h=Object(d.a)(u,s,[],!1,null,null,null);h.options.__file="src/views/Home/ShopCategory.vue";e.default=h.exports}}]);