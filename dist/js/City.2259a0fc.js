(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{161:function(t,e,o){"use strict";o.d(e,"f",(function(){return r})),o.d(e,"d",(function(){return n})),o.d(e,"e",(function(){return a})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return i})),o.d(e,"b",(function(){return c}));var r=function(t,e){t&&localStorage.setItem(t,JSON.stringify(e))},n=function(t){if(t)return JSON.parse(localStorage.getItem(t))},a=function(t){t&&localStorage.removeItem(t)},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t.children[t.children.length-1],r=i(o);return r+e<t.parentElement.clientHeight+t.parentElement.scrollTop},i=function(t){for(var e=t.offsetTop;t=t.offsetParent;)e+=t.offsetTop;return e};var c=function(t,e,o,r,n){clearInterval(t.timer),t.timer=setInterval((function(){var r,a=!0,s=0,i=0,c=0;for(r in e)"opacity"===r?(s=100*parseFloat(window.getComputedStyle(t).opacity),i=100*parseFloat(e.opacity)):"scrollTop"===r?(s=t.scrollTop,i=parseInt(e.scrollTop)):(s=parseInt(window.getComputedStyle(t)[r]),i=parseInt(e[r])),c=i>s?Math.ceil((i-s)*o):Math.floor((i-s)*o),"opacity"===r?t.style.opacity=(s+c)/100:"scrollTop"===r?t.scrollTop=s+c:"zIndex"===r?t.style.zIndex=i:t.style[r]=s+c+"px",Math.round(s)!==Math.round(i)&&(a=!1);if(a){for(r in clearInterval(t.timer),e)"opacity"===r||"zIndex"===r?t.style[r]=parseFloat(e[r]):"scrollTop"===r?t.scrollTop=parseFloat(e.scrollTop):t.style[r]=parseFloat(e[r])+"px";n&&n()}}),r)}},166:function(t,e,o){},192:function(t,e,o){"use strict";var r=o(166);o.n(r).a},237:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"city"}},[o("top-bar",{attrs:{"show-back":"",title:t.cityInfo.name}}),t._v(" "),o("form",{on:{submit:function(t){t.preventDefault()}}},[o("div",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text",placeholder:"输入学校、写字楼、地址"},domProps:{value:t.keyword},on:{input:[function(e){e.target.composing||(t.keyword=e.target.value)},t.searchPlace]}})])]),t._v(" "),o("ul",{staticClass:"search-result"},t._l(t.searchResult,(function(e,r){return o("li",{key:r,on:{tap:function(o){return t.handleTap(e)}}},[o("h4",{staticClass:"ellipsis"},[t._v(t._s(e.name))]),t._v(" "),o("p",{staticClass:"ellipsis"},[t._v(t._s(e.address))])])})),0),t._v(" "),t.placeHistory.length?o("h4",{staticClass:"search-history-header"},[t._v("搜索历史")]):t._e(),t._v(" "),o("ul",{staticClass:"search-history"},t._l(t.placeHistory,(function(e,r){return o("li",{key:r,on:{tap:function(o){return t.handleHistoryTap(e)}}},[o("h4",[t._v(t._s(e.name))]),t._v(" "),o("p",[t._v(t._s(e.address))])])})),0),t._v(" "),t.placeHistory.length?o("button",{on:{tap:t.clearStorage}},[t._v("清空所有")]):t._e()],1)};r._withStripped=!0;o(62);var n=o(13),a=o(55),s=o(1),i=o(161),c={name:"City",components:{TopBar:a.a},data:function(){return{id:this.$route.query.id,keyword:"",searchResult:[],placeHistory:[]}},computed:Object(n.c)(["cityInfo"]),watch:{id:function(t,e){this.$store.dispatch("fetchCityInfo",t)}},beforeRouteEnter:function(t,e,o){"/home"===e.path?t.meta.transitionName="slide-to-right":t.meta.transitionName="slide-to-left",o()},asyncData:function(t){var e=t.store,o=t.route;return e.dispatch("fetchCityInfo",o.query.id)},beforeMount:function(){this.placeHistory=Object(i.d)("placeHistory")||[]},activated:function(){this.id=this.$route.query.id},deactivated:function(){this.keyword="",this.searchResult=[]},methods:{searchPlace:function(){var t=this;this.keyword?Object(s.y)(this.id,this.keyword).then((function(e){var o=e.data;t.searchResult=o})):this.searchResult=[]},handleTap:function(t){this.$router.push("/home?geohash="+t.geohash),this.placeHistory.push({name:t.name,address:t.address,geohash:t.geohash}),Object(i.f)("placeHistory",this.placeHistory)},handleHistoryTap:function(t){this.$router.push("/home?geohash="+t.geohash)},clearStorage:function(){this.placeHistory=[],Object(i.e)("placeHistory")}}},l=(o(192),o(7)),u=Object(l.a)(c,r,[],!1,null,null,null);u.options.__file="src/views/City.vue";e.default=u.exports}}]);