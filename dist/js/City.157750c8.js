(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{155:function(t,e,n){},156:function(t,e,n){"use strict";var r=n(155);n.n(r).a},157:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"top-bar",class:{right:!t.showBack&&!t.$slots.left&&t.$slots.right}},[t._t("left"),t._v(" "),t.showBack?n("i",{staticClass:"el-icon-arrow-left top-bar-go-back",on:{tap:function(e){return t.$router.go(-1)}}}):t._e(),t._v(" "),n("span",{staticClass:"top-bar-title ellipsis"},[t._v(t._s(t.title))]),t._v(" "),t._t("right")],2)};r._withStripped=!0;var s=n(39),o={name:"TopBar",props:{title:{type:String},showBack:{type:Boolean}},computed:Object(s.c)(["userInfo"])},a=(n(156),n(17)),i=Object(a.a)(o,r,[],!1,null,null,null);i.options.__file="src/components/TopBar.vue";e.a=i.exports},159:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i}));var r=function(t,e){t&&localStorage.setItem(t,JSON.stringify(e))},s=function(t){if(t)return JSON.parse(localStorage.getItem(t))},o=function(t){t&&localStorage.removeItem(t)},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.children[t.children.length-1],r=i(n);return r+e<t.parentElement.clientHeight+t.parentElement.scrollTop},i=function(t){for(var e=t.offsetTop;t=t.offsetParent;)e+=t.offsetTop;return e}},165:function(t,e,n){},192:function(t,e,n){"use strict";var r=n(165);n.n(r).a},239:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"city"}},[n("top-bar",{attrs:{"show-back":"",title:t.cityInfo.name}}),t._v(" "),n("form",{on:{submit:function(t){t.preventDefault()}}},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text",placeholder:"输入学校、写字楼、地址"},domProps:{value:t.keyword},on:{input:[function(e){e.target.composing||(t.keyword=e.target.value)},t.searchPlace]}})])]),t._v(" "),n("ul",{staticClass:"search-result"},t._l(t.searchResult,(function(e,r){return n("li",{key:r,on:{tap:function(n){return t.handleTap(e)}}},[n("h4",{staticClass:"ellipsis"},[t._v(t._s(e.name))]),t._v(" "),n("p",{staticClass:"ellipsis"},[t._v(t._s(e.address))])])})),0),t._v(" "),t.placeHistory.length?n("h4",{staticClass:"search-history-header"},[t._v("搜索历史")]):t._e(),t._v(" "),n("ul",{staticClass:"search-history"},t._l(t.placeHistory,(function(e,r){return n("li",{key:r,on:{tap:function(n){return t.handleHistoryTap(e)}}},[n("h4",[t._v(t._s(e.name))]),t._v(" "),n("p",[t._v(t._s(e.address))])])})),0),t._v(" "),t.placeHistory.length?n("button",{on:{tap:t.clearStorage}},[t._v("清空所有")]):t._e()],1)};r._withStripped=!0;n(81);var s=n(39),o=n(157),a=n(2),i=n(159),c={name:"City",components:{TopBar:o.a},data:function(){return{id:this.$route.query.id,keyword:"",searchResult:[],placeHistory:[]}},computed:Object(s.c)(["cityInfo"]),watch:{id:function(t,e){this.$store.dispatch("fetchCityInfo",t)}},beforeRouteEnter:function(t,e,n){"/home"===e.path?t.meta.transitionName="slide-to-right":t.meta.transitionName="slide-to-left",n()},asyncData:function(t){var e=t.store,n=t.route;return e.dispatch("fetchCityInfo",n.query.id)},beforeMount:function(){this.placeHistory=Object(i.c)("placeHistory")||[]},activated:function(){this.id=this.$route.query.id},deactivated:function(){this.keyword="",this.searchResult=[]},methods:{searchPlace:function(){var t=this;this.keyword?Object(a.y)(this.id,this.keyword).then((function(e){var n=e.data;t.searchResult=n})):this.searchResult=[]},handleTap:function(t){this.$router.push("/home?geohash="+t.geohash),this.placeHistory.push({name:t.name,address:t.address,geohash:t.geohash}),Object(i.e)("placeHistory",this.placeHistory)},handleHistoryTap:function(t){this.$router.push("/home?geohash="+t.geohash)},clearStorage:function(){this.placeHistory=[],Object(i.d)("placeHistory")}}},l=(n(192),n(17)),u=Object(l.a)(c,r,[],!1,null,null,null);u.options.__file="src/views/City.vue";e.default=u.exports}}]);