(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{161:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a}));var r=function(t,e){t&&localStorage.setItem(t,JSON.stringify(e))},i=function(t){if(t)return JSON.parse(localStorage.getItem(t))},o=function(t){t&&localStorage.removeItem(t)},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.children[t.children.length-1],r=a(n);return r+e<t.parentElement.clientHeight+t.parentElement.scrollTop},a=function(t){for(var e=t.offsetTop;t=t.offsetParent;)e+=t.offsetTop;return e}},166:function(t,e,n){},192:function(t,e,n){"use strict";var r=n(166);n.n(r).a},237:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"city"}},[n("top-bar",{attrs:{"show-back":"",title:t.cityInfo.name}}),t._v(" "),n("form",{on:{submit:function(t){t.preventDefault()}}},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text",placeholder:"输入学校、写字楼、地址"},domProps:{value:t.keyword},on:{input:[function(e){e.target.composing||(t.keyword=e.target.value)},t.searchPlace]}})])]),t._v(" "),n("ul",{staticClass:"search-result"},t._l(t.searchResult,(function(e,r){return n("li",{key:r,on:{tap:function(n){return t.handleTap(e)}}},[n("h4",{staticClass:"ellipsis"},[t._v(t._s(e.name))]),t._v(" "),n("p",{staticClass:"ellipsis"},[t._v(t._s(e.address))])])})),0),t._v(" "),t.placeHistory.length?n("h4",{staticClass:"search-history-header"},[t._v("搜索历史")]):t._e(),t._v(" "),n("ul",{staticClass:"search-history"},t._l(t.placeHistory,(function(e,r){return n("li",{key:r,on:{tap:function(n){return t.handleHistoryTap(e)}}},[n("h4",[t._v(t._s(e.name))]),t._v(" "),n("p",[t._v(t._s(e.address))])])})),0),t._v(" "),t.placeHistory.length?n("button",{on:{tap:t.clearStorage}},[t._v("清空所有")]):t._e()],1)};r._withStripped=!0;n(62);var i=n(13),o=n(55),s=n(1),a=n(161),c={name:"City",components:{TopBar:o.a},data:function(){return{id:this.$route.query.id,keyword:"",searchResult:[],placeHistory:[]}},computed:Object(i.c)(["cityInfo"]),watch:{id:function(t,e){this.$store.dispatch("fetchCityInfo",t)}},beforeRouteEnter:function(t,e,n){"/home"===e.path?t.meta.transitionName="slide-to-right":t.meta.transitionName="slide-to-left",n()},asyncData:function(t){var e=t.store,n=t.route;return e.dispatch("fetchCityInfo",n.query.id)},beforeMount:function(){this.placeHistory=Object(a.c)("placeHistory")||[]},activated:function(){this.id=this.$route.query.id},deactivated:function(){this.keyword="",this.searchResult=[]},methods:{searchPlace:function(){var t=this;this.keyword?Object(s.y)(this.id,this.keyword).then((function(e){var n=e.data;t.searchResult=n})):this.searchResult=[]},handleTap:function(t){this.$router.push("/home?geohash="+t.geohash),this.placeHistory.push({name:t.name,address:t.address,geohash:t.geohash}),Object(a.e)("placeHistory",this.placeHistory)},handleHistoryTap:function(t){this.$router.push("/home?geohash="+t.geohash)},clearStorage:function(){this.placeHistory=[],Object(a.d)("placeHistory")}}},u=(n(192),n(7)),l=Object(u.a)(c,r,[],!1,null,null,null);l.options.__file="src/views/City.vue";e.default=l.exports}}]);