(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{155:function(t,e,s){},156:function(t,e,s){"use strict";var a=s(155);s.n(a).a},157:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"top-bar",class:{right:!t.showBack&&!t.$slots.left&&t.$slots.right}},[t._t("left"),t._v(" "),t.showBack?s("i",{staticClass:"el-icon-arrow-left top-bar-go-back",on:{tap:function(e){return t.$router.go(-1)}}}):t._e(),t._v(" "),s("span",{staticClass:"top-bar-title ellipsis"},[t._v(t._s(t.title))]),t._v(" "),t._t("right")],2)};a._withStripped=!0;var r=s(39),i={name:"TopBar",props:{title:{type:String},showBack:{type:Boolean}},computed:Object(r.c)(["userInfo"])},n=(s(156),s(17)),o=Object(n.a)(i,a,[],!1,null,null,null);o.options.__file="src/components/TopBar.vue";e.a=o.exports},159:function(t,e,s){"use strict";s.d(e,"e",(function(){return a})),s.d(e,"c",(function(){return r})),s.d(e,"d",(function(){return i})),s.d(e,"b",(function(){return n})),s.d(e,"a",(function(){return o}));var a=function(t,e){t&&localStorage.setItem(t,JSON.stringify(e))},r=function(t){if(t)return JSON.parse(localStorage.getItem(t))},i=function(t){t&&localStorage.removeItem(t)},n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=t.children[t.children.length-1],a=o(s);return a+e<t.parentElement.clientHeight+t.parentElement.scrollTop},o=function(t){for(var e=t.offsetTop;t=t.offsetParent;)e+=t.offsetTop;return e}},174:function(t,e,s){},200:function(t,e,s){"use strict";var a=s(174);s.n(a).a},237:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"confirm-order"}},[s("top-bar",{attrs:{"show-back":"",title:"确认订单"}}),t._v(" "),s("div",{staticClass:"address",on:{tap:function(e){return t.$router.push("/chooseAddress")}}},[t.allAddress.length?s("div",{staticClass:"ready"},[s("section",[s("span",{staticClass:"el-icon-location-outline"}),t._v(" "),s("section",[s("div",[s("span",[t._v(t._s(t.allAddress[t.chosenIndex].name))]),t._v(" "),s("i",[t._v(t._s(1===t.allAddress[t.chosenIndex].sex?"先生":"女士"))]),t._v(" "),s("b",[t._v(t._s(t.allAddress[t.chosenIndex].phone))])]),t._v(" "),s("div",[s("i",[t._v(t._s(t.allAddress[t.chosenIndex].tag))]),t._v(" "),s("span",[t._v(t._s(t.allAddress[t.chosenIndex].address))]),t._v(" "),s("b",[t._v(t._s(t.allAddress[t.chosenIndex].address_detail))])])])]),t._v(" "),s("i",{staticClass:"el-icon-arrow-right"})]):s("div",{staticClass:"empty"},[s("span",{staticClass:"el-icon-location-outline"},[t._v("请选择一个地址")]),t._v(" "),s("i",{staticClass:"el-icon-arrow-right"})])]),t._v(" "),s("div",{staticClass:"time"},[s("p",[t._v("送达时间")]),t._v(" "),s("div",[s("span",[t._v("尽快送达 | 预计"+t._s(t.checkData.delivery_reach_time))]),t._v(" "),t.checkData.cart.is_deliver_by_fengniao?s("i",[t._v("蜂鸟专送")]):t._e()])]),t._v(" "),s("div",{staticClass:"payment"},[s("div",[s("span",[t._v("支付方式")]),t._v(" "),s("div",{on:{tap:function(e){t.showDrawer=!0}}},[s("b",[t._v(t._s(t.payName))]),t._v(" "),s("i",{staticClass:"el-icon-arrow-up"})])]),t._v(" "),t._m(0)]),t._v(" "),s("div",{staticClass:"group"},[s("div",[s("img",{attrs:{src:t.imgBaseURL+t.checkData.cart.restaurant_info.image_path,alt:""}}),t._v(" "),s("span",[t._v(t._s(t.checkData.cart.restaurant_info.name))])]),t._v(" "),s("ul",t._l(t.checkData.cart.groups[0],(function(e,a){return s("li",{key:a},[s("p",[t._v(t._s(e.name))]),t._v(" "),s("div",[s("b",[t._v("×"+t._s(e.quantity))]),t._v(" "),s("i",[t._v("￥"+t._s(t._f("toFixed2")(e.price*e.quantity)))])])])})),0),t._v(" "),s("ul",[s("li",[s("p",[t._v("包装费")]),t._v(" "),s("i",[t._v("￥"+t._s(t._f("toFixed2")(t.totalPackingFee)))])]),t._v(" "),s("li",[s("p",[t._v("配送费")]),t._v(" "),s("i",[t._v("￥"+t._s(t._f("toFixed2")(t.deliveryFee)))])])]),t._v(" "),s("div",[s("span",[t._v("小计￥"),s("b",[t._v(t._s(t._f("toFixed2")(t.totalPrice)))])])])]),t._v(" "),s("div",{staticClass:"note"},[s("span",[t._v("订单备注")]),t._v(" "),s("div",{on:{tap:function(e){return t.$router.push("/addNote?id="+t.id+"&sig="+t.checkData.sig)}}},[t.formattedNote?s("b",{staticClass:"ellipsis"},[t._v(t._s(t.formattedNote))]):s("b",[t._v("口味、偏好等")]),t._v(" "),s("i",{staticClass:"el-icon-arrow-right"})])]),t._v(" "),s("div",{staticClass:"bar"},[s("p",[t._v("待支付￥"+t._s(t._f("toFixed2")(t.totalPrice)))]),t._v(" "),s("span",{on:{tap:t.confirm}},[t._v("确认下单")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDrawer,expression:"showDrawer"}],staticClass:"mask",on:{tap:function(e){t.showDrawer=!1}}}),t._v(" "),s("transition",{attrs:{name:"zoom-in-bottom"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDrawer,expression:"showDrawer"}],staticClass:"drawer"},[s("header",[t._v("支付方式")]),t._v(" "),s("ul",t._l(t.checkData.payments,(function(e,a){return s("li",{key:a},[s("span",[t._v(t._s(e.name))]),t._v(" "),s("i",{staticClass:"el-icon-success",class:{checked:t.payID===e.id},on:{tap:function(s){t.showDrawer=!1,t.payID=e.id,t.payName=e.name}}})])})),0)])])],1)};a._withStripped=!0;s(79),s(80),s(150),s(148),s(149),s(76),s(52),s(77),s(78);var r=s(53),i=s.n(r),n=s(39),o=s(157),c=s(2),l=s(51),h=s(159);function u(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}var d={name:"ConfirmOrder",components:{TopBar:o.a},data:function(){return{id:this.$route.query.id,geohash:this.$route.query.geohash,showDrawer:!1,payName:"货到付款",payID:2,fromElse:!1,imgBaseURL:l.b}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?u(Object(s),!0).forEach((function(e){i()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},Object(n.c)(["cart","checkData","allAddress","chosenIndex","quickNote","customNote","userInfo"]),{shoppingCart:function(){return this.cart[this.id]||{}},formattedShopCart:function(){var t=this,e=[];return Object.keys(this.shoppingCart).forEach((function(s){Object.keys(t.shoppingCart[s]).forEach((function(a){t.shoppingCart[s][a]&&e.push(t.shoppingCart[s][a])}))})),e},deliveryFee:function(){return this.checkData.cart.restaurant_info.float_delivery_fee},totalPackingFee:function(){for(var t=0,e=0,s=this.checkData.cart.groups[0].length;e<s;e++)t+=this.checkData.cart.groups[0][e].quantity*this.checkData.cart.groups[0][e].packing_fee;return t},totalPrice:function(){for(var t=0,e=0,s=this.checkData.cart.groups[0].length;e<s;e++)t+=this.checkData.cart.groups[0][e].quantity*this.checkData.cart.groups[0][e].price;return t+=this.totalPackingFee,t+=this.deliveryFee},formattedNote:function(){return this.quickNote&&this.customNote?this.quickNote+"，"+this.customNote:this.quickNote||this.customNote}}),beforeRouteEnter:function(t,e,s){"/chooseAddress"===e.path||"/addNote"===e.path||"/payOnline"===e.path?(t.meta.transitionName="slide-to-right",s()):(t.meta.transitionName="slide-to-left",s((function(t){return t.fromElse=!0})))},activated:function(){var t=this;this.$nextTick((function(){t.fromElse&&t.initData()}))},deactivated:function(){this.fromElse=!1},methods:{initData:function(){var t=this.$store,e=this.id,s=this.geohash;return t.commit("setCheckData",{cart:{restaurant_info:{},groups:[[]]},payments:[]}),t.commit("setAllAddress",[]),Promise.all([t.dispatch("fetchCheckData",{geohash:s,id:e,entities:[this.formattedShopCart]}),t.dispatch("fetchAllAddress",this.userInfo.id)])},confirm:function(){var t=this;this.allAddress.length?Object(c.A)(this.userInfo.id,this.checkData.cart.id,this.allAddress[this.chosenIndex].id,this.id,[this.formattedShopCart],this.geohash,this.formattedNote).then((function(e){var s=e.data;1===s.status&&(t.$alert({type:"success",content:s.success}),t.$router.replace("/payOnline?geohash=".concat(t.geohash)),t.$store.commit("setCart",{}),t.$store.commit("setNote",{quickNote:"",customNote:""}),Object(h.d)("cartHistory"))})):this.$alert({type:"warning",content:"请先添加一个地址"})}}},v=(s(200),s(17)),p=Object(v.a)(d,a,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("span",[this._v("红包")]),this._v(" "),e("b",[this._v("暂时只在饿了么APP中支持")])])}],!1,null,null,null);p.options.__file="src/views/ConfirmOrder.vue";e.default=p.exports}}]);